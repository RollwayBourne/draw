<mxfile host="app.diagrams.net" modified="2021-06-19T04:51:46.055Z" agent="5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.106 Safari/537.36" etag="hVvBBDx0bAQdbnYdwnq6" version="14.7.8" type="github">
  <diagram id="mXL_hT3lJOxDt4WdNcI8" name="Page-1">
    <mxGraphModel dx="1038" dy="1793" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="KMiZhZzG1fysnHMmIbVh-5" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="KMiZhZzG1fysnHMmIbVh-1" target="KMiZhZzG1fysnHMmIbVh-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-1" value="传统spmvc" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="40" y="100" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-8" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="KMiZhZzG1fysnHMmIbVh-4" target="KMiZhZzG1fysnHMmIbVh-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-4" value="DispatcherServlet" style="whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="240" y="100" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-6" value="请求" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;" parent="1" vertex="1">
          <mxGeometry x="180" y="100" width="40" height="20" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-12" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="KMiZhZzG1fysnHMmIbVh-7" target="KMiZhZzG1fysnHMmIbVh-11" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-14" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="KMiZhZzG1fysnHMmIbVh-7" target="KMiZhZzG1fysnHMmIbVh-13" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-7" value="HandlerMapping" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="440" y="100" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-16" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="KMiZhZzG1fysnHMmIbVh-11" target="KMiZhZzG1fysnHMmIbVh-15" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-18" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="KMiZhZzG1fysnHMmIbVh-11" target="KMiZhZzG1fysnHMmIbVh-17" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-11" value="HandlerAdapter" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="640" y="100" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-26" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="KMiZhZzG1fysnHMmIbVh-13" target="KMiZhZzG1fysnHMmIbVh-25" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-13" value="&lt;div&gt;public interface HandlerMapping {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; //找到与请求对应的 Handler，封装为一个 HandlerExecutionChain 返回&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;/span&gt;&amp;nbsp; &amp;nbsp; &lt;b&gt;&amp;nbsp;HandlerExecutionChain&lt;/b&gt; getHandler(HttpServletRequest request) throws Exception;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="262.5" y="-80" width="475" height="90" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-15" value="&lt;div&gt;public interface HandlerAdapter {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; //针对给定的请求/响应对象调用目标 Handler&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;/span&gt;&amp;nbsp; &amp;nbsp; ModelAndView handle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="375" y="210" width="650" height="80" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-17" value="ModelAndView" style="whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="840" y="100" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-24" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="KMiZhZzG1fysnHMmIbVh-22" target="KMiZhZzG1fysnHMmIbVh-23" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-22" value="&lt;div style=&quot;&quot;&gt;&lt;span&gt;webFlux&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="1" vertex="1">
          <mxGeometry x="40" y="510" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-28" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="KMiZhZzG1fysnHMmIbVh-23" target="KMiZhZzG1fysnHMmIbVh-27" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-23" value="DispatcherHandler" style="whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="240" y="510" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-25" value="&lt;div&gt;public class HandlerExecutionChain {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; private final Object handler;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; private final List&amp;lt;HandlerInterceptor&amp;gt; interceptorList;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; private int interceptorIndex;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="300" y="-220" width="400" height="80" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-31" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="KMiZhZzG1fysnHMmIbVh-27" target="KMiZhZzG1fysnHMmIbVh-30" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-35" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="KMiZhZzG1fysnHMmIbVh-27" target="KMiZhZzG1fysnHMmIbVh-34" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-27" value="&lt;span&gt;HandlerMapping&lt;/span&gt;" style="whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="440" y="510" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-37" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="KMiZhZzG1fysnHMmIbVh-30" target="KMiZhZzG1fysnHMmIbVh-36" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-41" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="KMiZhZzG1fysnHMmIbVh-30" target="KMiZhZzG1fysnHMmIbVh-40" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-30" value="&lt;span&gt;HandlerAdapter&lt;/span&gt;" style="whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="640" y="510" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-34" value="&lt;div&gt;public interface HandlerMapping&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;/span&gt;&amp;nbsp; Mono&amp;lt;Object&amp;gt; getHandler(ServerWebExchange exchange);&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="320" y="390" width="360" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-39" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="KMiZhZzG1fysnHMmIbVh-36" target="KMiZhZzG1fysnHMmIbVh-38" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-36" value="&lt;div&gt;public interface HandlerAdapter {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; Mono&amp;lt;HandlerResult&amp;gt; handle(ServerWebExchange exchange, Object handler);&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="476.25" y="620" width="447.5" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-38" value="&lt;div&gt;public interface ServerWebExchange {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ServerHttpRequest getRequest();&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; ServerHttpResponse getResponse();&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;/span&gt;&amp;nbsp; &amp;nbsp; Map&amp;lt;String, Object&amp;gt; getAttributes();&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="580" y="740" width="240" height="90" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-40" value="&lt;pre style=&quot;background-color: #ffffff ; color: #080808 ; font-family: &amp;#34;jetbrains mono&amp;#34; , monospace ; font-size: 9.8pt&quot;&gt;&lt;span style=&quot;color: #000000&quot;&gt;HandlerResult&lt;/span&gt;&lt;/pre&gt;" style="whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="840" y="510" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-43" value="基于servlet协议，bio，因为不知道数据何时就绪，为每一个socket创建一个线程，使得线程可以在read()中阻塞，直到数据就绪完毕。实际上每个阻塞的线程充当了socket监视器，将java虚拟机的线程调度充当了通知机制。在高并发的场景下，将无线程可用，使得后续的请求阻塞在等待线程空余上。同时工作线程的大部分时间都浪费在阻塞上，cpu的能力没有得到有效发挥。" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="1121" y="85" width="450" height="90" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-45" value="非阻塞异步框架，基于io多路复用，将多个io通道交给Selector处理，工作线程只需要在有io就绪时进行处理即可，所以吞吐量提高了，cpu的能力得到发挥。但传统的jdbc与webflux将不在契合，传统的jdbc是bio，没有nio实现. 使用spring data提供的r2dbc或Mongodb,redis等非关系型数据库可支持解决这个问题。已支持的关系型数据为有pg.h2,mssql,mysql等。" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="1121" y="485" width="469" height="110" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-47" value="" style="shape=singleArrow;direction=south;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="800" y="880" width="60" height="100" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-51" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="KMiZhZzG1fysnHMmIbVh-49" target="KMiZhZzG1fysnHMmIbVh-50" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-49" value="注解式开发构建webflux服务" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="20" y="1050" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-50" value="&lt;div&gt;@RestController&lt;/div&gt;&lt;div&gt;public class HelloController {&lt;/div&gt;&lt;div&gt;&amp;nbsp;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; @GetMapping(&quot;/&quot;)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; public Mono&amp;lt;String&amp;gt; hello() {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; return Mono.just(&quot;Hello World!&quot;);&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="330" y="1010" width="280" height="140" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-52" value="函数式编程构建webflux服务" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="20" y="1240" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-53" value="&lt;b&gt;ServerRequest&lt;br&gt;&lt;/b&gt;Mono&amp;lt;Order&amp;gt; order = request.bodyToMono(Order.class)&amp;nbsp; 内部调用&lt;br&gt;Mono&amp;lt;Order&amp;gt; body=request.body(BodyExtractors.toMono(Order.class));" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="230" y="1240" width="410" height="70" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-57" value="&lt;b&gt;ServerResponse&lt;/b&gt;&lt;br&gt;&lt;div&gt;ServerResponse.ok().contentType(MediaType.APPLICATION_JSON)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; .body(BodyInserters.fromValue(new Order()));&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="230" y="1340" width="410" height="60" as="geometry" />
        </mxCell>
        <mxCell id="PuQ9t5COlBX9batZbNy5-2" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="KMiZhZzG1fysnHMmIbVh-58" target="PuQ9t5COlBX9batZbNy5-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-58" value="&lt;b&gt;HandlerFunction&lt;/b&gt;&lt;br&gt;&lt;div&gt;@FunctionalInterface&lt;/div&gt;&lt;div&gt;public interface HandlerFunction&amp;lt;T extends ServerResponse&amp;gt; {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; Mono&amp;lt;T&amp;gt; handle(ServerRequest var1);&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div style=&quot;font-weight: bold&quot;&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="230" y="1420" width="410" height="100" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-61" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="KMiZhZzG1fysnHMmIbVh-59" target="KMiZhZzG1fysnHMmIbVh-60" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-59" value="&lt;b&gt;RouterFunction&lt;/b&gt;&lt;br&gt;&lt;div&gt;@FunctionalInterface&lt;/div&gt;&lt;div&gt;public interface RouterFunction&amp;lt;T extends ServerResponse&amp;gt; {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; Mono&amp;lt;HandlerFunction&amp;lt;T&amp;gt;&amp;gt; route(ServerRequest var1);&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="230" y="1661.25" width="410" height="90" as="geometry" />
        </mxCell>
        <mxCell id="PuQ9t5COlBX9batZbNy5-3" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="KMiZhZzG1fysnHMmIbVh-60" target="KMiZhZzG1fysnHMmIbVh-63" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-60" value="&lt;pre style=&quot;background-color: rgb(255 , 255 , 255)&quot;&gt;&lt;pre style=&quot;color: rgb(8 , 8 , 8) ; font-family: &amp;#34;jetbrains mono&amp;#34; , monospace ; font-size: 9.8pt&quot;&gt;&lt;pre style=&quot;font-family: &amp;#34;jetbrains mono&amp;#34; , monospace ; font-size: 9.8pt&quot;&gt;&lt;span style=&quot;color: #9e880d&quot;&gt;@Bean&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #0033b3&quot;&gt;public &lt;/span&gt;&lt;span style=&quot;color: #000000&quot;&gt;RouterFunction &lt;/span&gt;&lt;span style=&quot;color: #00627a&quot;&gt;routerOrder&lt;/span&gt;(&lt;span style=&quot;color: #000000&quot;&gt;HelloWorldFunctionHandler &lt;/span&gt;helloWorldFunctionHandler){&lt;br&gt;    &lt;span style=&quot;color: #0033b3&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color: #000000&quot;&gt;RouterFunctions&lt;/span&gt;.&lt;span style=&quot;font-style: italic&quot;&gt;route&lt;/span&gt;(&lt;span style=&quot;color: #000000&quot;&gt;RequestPredicates&lt;/span&gt;.&lt;span style=&quot;font-style: italic&quot;&gt;POST&lt;/span&gt;(&lt;span style=&quot;color: #067d17&quot;&gt;&quot;/hello&quot;&lt;/span&gt;)&lt;br&gt;                    .and(&lt;span style=&quot;color: #000000&quot;&gt;RequestPredicates&lt;/span&gt;.&lt;span style=&quot;font-style: italic&quot;&gt;accept&lt;/span&gt;(&lt;span style=&quot;color: #000000&quot;&gt;MediaType&lt;/span&gt;.&lt;span style=&quot;color: #871094 ; font-style: italic&quot;&gt;APPLICATION_JSON&lt;/span&gt;))&lt;br&gt;            ,helloWorldFunctionHandler)&lt;br&gt;            .andRoute(&lt;span style=&quot;color: #000000&quot;&gt;RequestPredicates&lt;/span&gt;.&lt;span style=&quot;font-style: italic&quot;&gt;POST&lt;/span&gt;(&lt;span style=&quot;color: #067d17&quot;&gt;&quot;saySomething&quot;&lt;/span&gt;)&lt;br&gt;                    ,helloWorldFunctionHandler::saySomething);&lt;br&gt;}&lt;/pre&gt;&lt;pre style=&quot;font-family: &amp;#34;jetbrains mono&amp;#34; , monospace ; font-size: 9.8pt&quot;&gt;//通过谓词绑定functionhandler&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="730" y="1620" width="570" height="172.5" as="geometry" />
        </mxCell>
        <mxCell id="KMiZhZzG1fysnHMmIbVh-63" value="&lt;div&gt;&lt;b&gt;DefaultRouterFunction&lt;/b&gt;&lt;/div&gt;&lt;div&gt;public Mono&amp;lt;HandlerFunction&amp;lt;T&amp;gt;&amp;gt; route(ServerRequest request) {&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;/span&gt;&amp;nbsp; &amp;nbsp; if (this.predicate.test(request)) {&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;/span&gt;&amp;nbsp; &amp;nbsp; return Mono.just(this.handlerFunction);&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;/span&gt;&amp;nbsp; &amp;nbsp;} else {&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;/span&gt;&amp;nbsp; &amp;nbsp; return Mono.empty();&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;/span&gt;&amp;nbsp; &amp;nbsp;}&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="800" y="1831.25" width="430" height="150" as="geometry" />
        </mxCell>
        <mxCell id="PuQ9t5COlBX9batZbNy5-1" value="&lt;pre style=&quot;background-color: #ffffff ; color: #080808 ; font-family: &amp;#34;jetbrains mono&amp;#34; , monospace ; font-size: 9.8pt&quot;&gt;&lt;span style=&quot;color: #9e880d&quot;&gt;@Configuration&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #0033b3&quot;&gt;public class &lt;/span&gt;&lt;span style=&quot;color: #000000&quot;&gt;HelloWorldFunctionHandler &lt;/span&gt;&lt;span style=&quot;color: #0033b3&quot;&gt;implements &lt;/span&gt;&lt;span style=&quot;color: #000000&quot;&gt;HandlerFunction&lt;/span&gt;&amp;lt;&lt;span style=&quot;color: #000000&quot;&gt;ServerResponse&lt;/span&gt;&amp;gt; {&lt;br&gt;    &lt;span style=&quot;color: #9e880d&quot;&gt;@Override&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #9e880d&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #0033b3&quot;&gt;public &lt;/span&gt;&lt;span style=&quot;color: #000000&quot;&gt;Mono&lt;/span&gt;&amp;lt;&lt;span style=&quot;color: #000000&quot;&gt;ServerResponse&lt;/span&gt;&amp;gt; &lt;span style=&quot;color: #00627a&quot;&gt;handle&lt;/span&gt;(&lt;span style=&quot;color: #000000&quot;&gt;ServerRequest &lt;/span&gt;serverRequest) {&lt;br&gt;        &lt;span style=&quot;color: #0033b3&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color: #000000&quot;&gt;ServerResponse&lt;/span&gt;.&lt;span style=&quot;font-style: italic&quot;&gt;ok&lt;/span&gt;().contentType(&lt;span style=&quot;color: #000000&quot;&gt;MediaType&lt;/span&gt;.&lt;span style=&quot;color: #871094 ; font-style: italic&quot;&gt;APPLICATION_JSON&lt;/span&gt;)&lt;br&gt;                .body(&lt;span style=&quot;color: #000000&quot;&gt;BodyInserters&lt;/span&gt;.&lt;span style=&quot;font-style: italic&quot;&gt;fromValue&lt;/span&gt;(&lt;span style=&quot;color: #067d17&quot;&gt;&quot;hello world~&quot;&lt;/span&gt;));&lt;br&gt;    }&lt;br&gt;    &lt;span style=&quot;color: #0033b3&quot;&gt;public &lt;/span&gt;&lt;span style=&quot;color: #000000&quot;&gt;Mono&lt;/span&gt;&amp;lt;&lt;span style=&quot;color: #000000&quot;&gt;ServerResponse&lt;/span&gt;&amp;gt; &lt;span style=&quot;color: #00627a&quot;&gt;saySomething&lt;/span&gt;(&lt;span style=&quot;color: #000000&quot;&gt;ServerRequest &lt;/span&gt;serverRequest) {&lt;br&gt;        &lt;span style=&quot;color: #0033b3&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color: #000000&quot;&gt;ServerResponse&lt;/span&gt;.&lt;span style=&quot;font-style: italic&quot;&gt;ok&lt;/span&gt;().contentType(&lt;span style=&quot;color: #000000&quot;&gt;MediaType&lt;/span&gt;.&lt;span style=&quot;color: #871094 ; font-style: italic&quot;&gt;APPLICATION_JSON&lt;/span&gt;)&lt;br&gt;                .body(&lt;span style=&quot;color: #000000&quot;&gt;BodyInserters&lt;/span&gt;.&lt;span style=&quot;font-style: italic&quot;&gt;fromValue&lt;/span&gt;(&lt;span style=&quot;color: #067d17&quot;&gt;&quot;say something&quot;&lt;/span&gt;));&lt;br&gt;    }&lt;br&gt;}&lt;br&gt;&lt;/pre&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="730" y="1368.13" width="540" height="203.75" as="geometry" />
        </mxCell>
        <mxCell id="PuQ9t5COlBX9batZbNy5-4" value="" style="shape=singleArrow;direction=south;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="800" y="2030" width="60" height="100" as="geometry" />
        </mxCell>
        <mxCell id="PuQ9t5COlBX9batZbNy5-6" value="非阻塞跨服务调用" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="40" y="2200" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="PuQ9t5COlBX9batZbNy5-7" value="&lt;b&gt;WebClient&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="190" y="2200" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="PuQ9t5COlBX9batZbNy5-8" value="&lt;pre style=&quot;background-color: #ffffff ; color: #080808 ; font-family: &amp;#34;jetbrains mono&amp;#34; , monospace ; font-size: 9.8pt&quot;&gt;&lt;pre style=&quot;font-family: &amp;#34;jetbrains mono&amp;#34; , monospace ; font-size: 9.8pt&quot;&gt;&lt;span style=&quot;color: #8c8c8c ; font-style: italic&quot;&gt;//retrieve&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #000000&quot;&gt;MultiValueMap&lt;/span&gt;&amp;lt;&lt;span style=&quot;color: #000000&quot;&gt;String&lt;/span&gt;,&lt;span style=&quot;color: #000000&quot;&gt;Object&lt;/span&gt;&amp;gt; &lt;span style=&quot;color: #000000&quot;&gt;formMap &lt;/span&gt;= &lt;span style=&quot;color: #0033b3&quot;&gt;new &lt;/span&gt;LinkedMultiValueMap&amp;lt;&amp;gt;();&lt;br&gt;&lt;span style=&quot;color: #000000&quot;&gt;formMap&lt;/span&gt;.add(&lt;span style=&quot;color: #067d17&quot;&gt;&quot;name&quot;&lt;/span&gt;,&lt;span style=&quot;color: #067d17&quot;&gt;&quot;123&quot;&lt;/span&gt;);&lt;br&gt;&lt;span style=&quot;color: #0033b3&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color: #000000&quot;&gt;WebClient&lt;/span&gt;.&lt;span style=&quot;font-style: italic&quot;&gt;create&lt;/span&gt;(&lt;span style=&quot;color: #067d17&quot;&gt;&quot;http://localhost:9081&quot;&lt;/span&gt;).post()&lt;br&gt;        .uri(&lt;span style=&quot;color: #067d17&quot;&gt;&quot;/user/getUserInfo&quot;&lt;/span&gt;)&lt;br&gt;        .header(&lt;span style=&quot;color: #067d17&quot;&gt;&quot;authorization&quot;&lt;/span&gt;,&lt;span style=&quot;color: #067d17&quot;&gt;&quot;authorization header...&quot;&lt;/span&gt;)&lt;br&gt;        .body(&lt;span style=&quot;color: #000000&quot;&gt;Mono&lt;/span&gt;.&lt;span style=&quot;font-style: italic&quot;&gt;just&lt;/span&gt;(&lt;span style=&quot;color: #000000&quot;&gt;formMap&lt;/span&gt;),&lt;span style=&quot;color: #000000&quot;&gt;MultiValueMap&lt;/span&gt;.&lt;span style=&quot;color: #0033b3&quot;&gt;class&lt;/span&gt;)&lt;br&gt;        .retrieve()&lt;br&gt;        &lt;span style=&quot;color: #8c8c8c ; font-style: italic&quot;&gt;//retrive&lt;/span&gt;&lt;span style=&quot;color: #8c8c8c ; font-style: italic ; font-family: &amp;#34;宋体&amp;#34; , monospace&quot;&gt;可使用&lt;/span&gt;&lt;span style=&quot;color: #8c8c8c ; font-style: italic&quot;&gt;onStatus&lt;/span&gt;&lt;span style=&quot;color: #8c8c8c ; font-style: italic ; font-family: &amp;#34;宋体&amp;#34; , monospace&quot;&gt;方法对异常进行处理&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #8c8c8c ; font-style: italic ; font-family: &amp;#34;宋体&amp;#34; , monospace&quot;&gt;        &lt;/span&gt;.onStatus(&lt;span style=&quot;color: #000000&quot;&gt;HttpStatus&lt;/span&gt;::is4xxClientError,clientResponse -&amp;gt; &lt;span style=&quot;color: #000000&quot;&gt;Mono&lt;/span&gt;.&lt;span style=&quot;font-style: italic&quot;&gt;error&lt;/span&gt;(&lt;span style=&quot;color: #0033b3&quot;&gt;new &lt;/span&gt;RuntimeException(&lt;span style=&quot;color: #067d17&quot;&gt;&quot;xxx&quot;&lt;/span&gt;)))&lt;br&gt;        .bodyToMono(&lt;span style=&quot;color: #000000&quot;&gt;String&lt;/span&gt;.&lt;span style=&quot;color: #0033b3&quot;&gt;class&lt;/span&gt;);&lt;/pre&gt;&lt;/pre&gt;" style="whiteSpace=wrap;html=1;rounded=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="414" y="2140" width="690" height="180" as="geometry" />
        </mxCell>
        <mxCell id="PuQ9t5COlBX9batZbNy5-12" value="&lt;pre style=&quot;background-color: #ffffff ; color: #080808 ; font-family: &amp;#34;jetbrains mono&amp;#34; , monospace ; font-size: 9.8pt&quot;&gt;&lt;span style=&quot;color: #8c8c8c ; font-style: italic&quot;&gt;//exchange json&lt;/span&gt;&lt;span style=&quot;color: #8c8c8c ; font-style: italic ; font-family: &amp;#34;宋体&amp;#34; , monospace&quot;&gt;请求&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #000000&quot;&gt;Map&lt;/span&gt;&amp;lt;&lt;span style=&quot;color: #000000&quot;&gt;String&lt;/span&gt;,&lt;span style=&quot;color: #000000&quot;&gt;Object&lt;/span&gt;&amp;gt; &lt;span style=&quot;color: #000000&quot;&gt;map &lt;/span&gt;= &lt;span style=&quot;color: #0033b3&quot;&gt;new &lt;/span&gt;HashMap&amp;lt;&amp;gt;();&lt;br&gt;&lt;span style=&quot;color: #000000&quot;&gt;map&lt;/span&gt;.put(&lt;span style=&quot;color: #067d17&quot;&gt;&quot;name&quot;&lt;/span&gt;,&lt;span style=&quot;color: #067d17&quot;&gt;&quot;123&quot;&lt;/span&gt;);&lt;br&gt;&lt;span style=&quot;color: #0033b3&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color: #000000&quot;&gt;WebClient&lt;/span&gt;.&lt;span style=&quot;font-style: italic&quot;&gt;create&lt;/span&gt;().post()&lt;br&gt;        .uri(&lt;span style=&quot;color: #067d17&quot;&gt;&quot;http://localhost:9081/user/getUserInfoII&quot;&lt;/span&gt;)&lt;br&gt;        .header(&lt;span style=&quot;color: #067d17&quot;&gt;&quot;authorization&quot;&lt;/span&gt;,&lt;span style=&quot;color: #067d17&quot;&gt;&quot;authorization header...&quot;&lt;/span&gt;)&lt;br&gt;        .contentType(&lt;span style=&quot;color: #000000&quot;&gt;MediaType&lt;/span&gt;.&lt;span style=&quot;color: #871094 ; font-style: italic&quot;&gt;APPLICATION_JSON&lt;/span&gt;)&lt;br&gt;        .bodyValue(&lt;span style=&quot;color: #000000&quot;&gt;map&lt;/span&gt;)&lt;br&gt;        .exchange()&lt;br&gt;        &lt;span style=&quot;color: #8c8c8c ; font-style: italic&quot;&gt;//exchange&lt;/span&gt;&lt;span style=&quot;color: #8c8c8c ; font-style: italic ; font-family: &amp;#34;宋体&amp;#34; , monospace&quot;&gt;可直接获取响应码&lt;/span&gt;&lt;span style=&quot;color: #8c8c8c ; font-style: italic&quot;&gt; cookie&lt;/span&gt;&lt;span style=&quot;color: #8c8c8c ; font-style: italic ; font-family: &amp;#34;宋体&amp;#34; , monospace&quot;&gt;等&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #8c8c8c ; font-style: italic ; font-family: &amp;#34;宋体&amp;#34; , monospace&quot;&gt;        &lt;/span&gt;.flatMap(clientResponse -&amp;gt;&lt;br&gt;                clientResponse.bodyToMono(&lt;span style=&quot;color: #000000&quot;&gt;String&lt;/span&gt;.&lt;span style=&quot;color: #0033b3&quot;&gt;class&lt;/span&gt;));&lt;/pre&gt;" style="whiteSpace=wrap;html=1;rounded=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="414" y="2350" width="696" height="210" as="geometry" />
        </mxCell>
        <mxCell id="pIQZ-Ir2BWbgscN9j-RT-1" value="&lt;pre style=&quot;background-color: #ffffff ; color: #080808 ; font-family: &amp;quot;jetbrains mono&amp;quot; , monospace ; font-size: 9.8pt&quot;&gt;&lt;span style=&quot;color: #8c8c8c ; font-style: italic&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #8c8c8c ; font-style: italic ; font-family: &amp;quot;宋体&amp;quot; , monospace&quot;&gt;传输文件&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #000000&quot;&gt;MultipartBodyBuilder builder &lt;/span&gt;= &lt;span style=&quot;color: #0033b3&quot;&gt;new &lt;/span&gt;MultipartBodyBuilder();&lt;br&gt;&lt;span style=&quot;color: #000000&quot;&gt;builder&lt;/span&gt;.part(&lt;span style=&quot;color: #067d17&quot;&gt;&quot;name&quot;&lt;/span&gt;, &lt;span style=&quot;color: #067d17&quot;&gt;&quot;123&quot;&lt;/span&gt;);&lt;br&gt;&lt;span style=&quot;color: #000000&quot;&gt;builder&lt;/span&gt;.part(&lt;span style=&quot;color: #067d17&quot;&gt;&quot;file&quot;&lt;/span&gt;, &lt;span style=&quot;color: #0033b3&quot;&gt;new &lt;/span&gt;FileSystemResource(&lt;span style=&quot;color: #067d17&quot;&gt;&quot;C:&lt;/span&gt;&lt;span style=&quot;color: #0037a6&quot;&gt;\\&lt;/span&gt;&lt;span style=&quot;color: #067d17&quot;&gt;Users&lt;/span&gt;&lt;span style=&quot;color: #0037a6&quot;&gt;\\&lt;/span&gt;&lt;span style=&quot;color: #067d17&quot;&gt;rollway&lt;/span&gt;&lt;span style=&quot;color: #0037a6&quot;&gt;\\&lt;/span&gt;&lt;span style=&quot;color: #067d17&quot;&gt;Desktop&lt;/span&gt;&lt;span style=&quot;color: #0037a6&quot;&gt;\\&lt;/span&gt;&lt;span style=&quot;color: #067d17&quot;&gt;webflux.png&quot;&lt;/span&gt;));&lt;br&gt;&lt;span style=&quot;color: #000000&quot;&gt;MultiValueMap&lt;/span&gt;&amp;lt;&lt;span style=&quot;color: #000000&quot;&gt;String&lt;/span&gt;, &lt;span style=&quot;color: #000000&quot;&gt;HttpEntity&lt;/span&gt;&amp;lt;?&amp;gt;&amp;gt; &lt;span style=&quot;color: #000000&quot;&gt;parts &lt;/span&gt;= &lt;span style=&quot;color: #000000&quot;&gt;builder&lt;/span&gt;.build();&lt;br&gt;&lt;span style=&quot;color: #0033b3&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color: #000000&quot;&gt;WebClient&lt;/span&gt;.&lt;span style=&quot;font-style: italic&quot;&gt;create&lt;/span&gt;().post()&lt;br&gt;        .uri(&lt;span style=&quot;color: #067d17&quot;&gt;&quot;http://localhost:9081/user/getUserInfoIII&quot;&lt;/span&gt;)&lt;br&gt;        .header(&lt;span style=&quot;color: #067d17&quot;&gt;&quot;authorization&quot;&lt;/span&gt;,&lt;span style=&quot;color: #067d17&quot;&gt;&quot;authorization header...&quot;&lt;/span&gt;)&lt;br&gt;        .bodyValue(&lt;span style=&quot;color: #000000&quot;&gt;parts&lt;/span&gt;)&lt;br&gt;        .exchange()&lt;br&gt;        .flatMap(clientResponse -&amp;gt;&lt;br&gt;                clientResponse.bodyToMono(&lt;span style=&quot;color: #000000&quot;&gt;String&lt;/span&gt;.&lt;span style=&quot;color: #0033b3&quot;&gt;class&lt;/span&gt;));&lt;/pre&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="413" y="2620" width="697" height="190" as="geometry" />
        </mxCell>
        <mxCell id="pIQZ-Ir2BWbgscN9j-RT-2" value="&lt;pre style=&quot;background-color: #ffffff ; color: #080808 ; font-family: &amp;quot;jetbrains mono&amp;quot; , monospace ; font-size: 9.8pt&quot;&gt;&lt;span style=&quot;color: #0033b3&quot;&gt;public &lt;/span&gt;&lt;span style=&quot;color: #000000&quot;&gt;Mono&lt;/span&gt;&amp;lt;&lt;span style=&quot;color: #000000&quot;&gt;String&lt;/span&gt;&amp;gt; &lt;span style=&quot;color: #00627a&quot;&gt;getOrderIV&lt;/span&gt;() {&lt;br&gt;    &lt;span style=&quot;color: #000000&quot;&gt;WebClient webClient &lt;/span&gt;= &lt;span style=&quot;color: #000000&quot;&gt;WebClient&lt;/span&gt;.&lt;span style=&quot;font-style: italic&quot;&gt;builder&lt;/span&gt;()&lt;br&gt;            .baseUrl(&lt;span style=&quot;color: #067d17&quot;&gt;&quot;http://localhost:9081&quot;&lt;/span&gt;)&lt;br&gt;            .filter(logFilter()).build();&lt;br&gt;    &lt;span style=&quot;color: #000000&quot;&gt;MultiValueMap&lt;/span&gt;&amp;lt;&lt;span style=&quot;color: #000000&quot;&gt;String&lt;/span&gt;, &lt;span style=&quot;color: #000000&quot;&gt;Object&lt;/span&gt;&amp;gt; &lt;span style=&quot;color: #000000&quot;&gt;formMap &lt;/span&gt;= &lt;span style=&quot;color: #0033b3&quot;&gt;new &lt;/span&gt;LinkedMultiValueMap&amp;lt;&amp;gt;();&lt;br&gt;    &lt;span style=&quot;color: #000000&quot;&gt;formMap&lt;/span&gt;.add(&lt;span style=&quot;color: #067d17&quot;&gt;&quot;name&quot;&lt;/span&gt;, &lt;span style=&quot;color: #067d17&quot;&gt;&quot;123&quot;&lt;/span&gt;);&lt;br&gt;    &lt;span style=&quot;color: #0033b3&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;color: #000000&quot;&gt;webClient&lt;/span&gt;.post()&lt;br&gt;            .uri(&lt;span style=&quot;color: #067d17&quot;&gt;&quot;/user/getUserInfo&quot;&lt;/span&gt;)&lt;br&gt;            .header(&lt;span style=&quot;color: #067d17&quot;&gt;&quot;authorization&quot;&lt;/span&gt;, &lt;span style=&quot;color: #067d17&quot;&gt;&quot;authorization header...&quot;&lt;/span&gt;)&lt;br&gt;            .body(&lt;span style=&quot;color: #000000&quot;&gt;Mono&lt;/span&gt;.&lt;span style=&quot;font-style: italic&quot;&gt;just&lt;/span&gt;(&lt;span style=&quot;color: #000000&quot;&gt;formMap&lt;/span&gt;), &lt;span style=&quot;color: #000000&quot;&gt;MultiValueMap&lt;/span&gt;.&lt;span style=&quot;color: #0033b3&quot;&gt;class&lt;/span&gt;)&lt;br&gt;            .retrieve()&lt;br&gt;            .bodyToMono(&lt;span style=&quot;color: #000000&quot;&gt;String&lt;/span&gt;.&lt;span style=&quot;color: #0033b3&quot;&gt;class&lt;/span&gt;);&lt;br&gt;}&lt;br&gt;&lt;br&gt;&lt;span style=&quot;color: #8c8c8c ; font-style: italic&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #8c8c8c ; font-style: italic ; font-family: &amp;quot;宋体&amp;quot; , monospace&quot;&gt;自定义过滤器 可添加固定参数等&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: #0033b3&quot;&gt;private &lt;/span&gt;&lt;span style=&quot;color: #000000&quot;&gt;ExchangeFilterFunction &lt;/span&gt;&lt;span style=&quot;color: #00627a&quot;&gt;logFilter&lt;/span&gt;() {&lt;br&gt;    &lt;span style=&quot;color: #0033b3&quot;&gt;return &lt;/span&gt;(clientRequest, next) -&amp;gt; {&lt;br&gt;        &lt;span style=&quot;color: #871094 ; font-style: italic&quot;&gt;log&lt;/span&gt;.info(&lt;span style=&quot;color: #067d17&quot;&gt;&quot;Request: {} {}&quot;&lt;/span&gt;, clientRequest.method(), clientRequest.url());&lt;br&gt;        clientRequest.headers()&lt;br&gt;                .forEach((name, values) -&amp;gt; values.forEach(value -&amp;gt; &lt;span style=&quot;color: #871094 ; font-style: italic&quot;&gt;log&lt;/span&gt;.info(&lt;span style=&quot;color: #067d17&quot;&gt;&quot;{}={}&quot;&lt;/span&gt;, &lt;span style=&quot;color: #851691&quot;&gt;name&lt;/span&gt;, value)));&lt;br&gt;        &lt;span style=&quot;color: #0033b3&quot;&gt;return &lt;/span&gt;next.exchange(clientRequest);&lt;br&gt;    };&lt;br&gt;}&lt;/pre&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="409" y="2840" width="700" height="430" as="geometry" />
        </mxCell>
        <mxCell id="75Hc36i8k2XXQKUzMVEF-1" value="&lt;font style=&quot;font-size: 14px&quot;&gt;&lt;span style=&quot;color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;响应式编程已经在&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-weight: 600 ; color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;Java&lt;/span&gt;&lt;span style=&quot;color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;&amp;nbsp;编程领域出现很长一段时间了，&lt;/span&gt;&lt;span style=&quot;color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;大部分情况下&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-weight: 600 ; color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;Java&lt;/span&gt;&lt;span style=&quot;color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;&amp;nbsp;使用&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-weight: 600 ; color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;JDBC&lt;/span&gt;&lt;span style=&quot;color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;&amp;nbsp;来操作关系型数据库，而&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-weight: 600 ; color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;JDBC&lt;/span&gt;&lt;span style=&quot;color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;&amp;nbsp;是阻塞的、同步的。&lt;/span&gt;&lt;span style=&quot;color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;目前市面上有两种响应式数据库驱动协议：&lt;br&gt;1.&lt;/span&gt;&lt;span style=&quot;background-color: rgb(255 , 255 , 255) ; color: rgb(18 , 18 , 18)&quot;&gt;&lt;b&gt;ADBA&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(51 , 51 , 51) ; font-family: &amp;#34;pingfang sc&amp;#34; , &amp;#34;microsoft yahei&amp;#34; , &amp;#34;helvetica neue&amp;#34; , &amp;#34;helvetica&amp;#34; , &amp;#34;arial&amp;#34; , sans-serif ; background-color: rgb(255 , 255 , 255)&quot;&gt;oracle提出的 ADBC (Asynchronous Database Access API)，&lt;/span&gt;&lt;span style=&quot;color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;目的性是集成于未来&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-weight: 600 ; color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;Java&lt;/span&gt;&lt;span style=&quot;color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;&amp;nbsp;的标准发行版中 but..&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: rgb(255 , 255 , 255)&quot;&gt;&lt;font color=&quot;#121212&quot; face=&quot;-apple-system, BlinkMacSystemFont, Helvetica Neue, PingFang SC, Microsoft YaHei, Source Han Sans SC, Noto Sans CJK SC, WenQuanYi Micro Hei, sans-serif&quot; style=&quot;font-size: 14px&quot;&gt;http://link.zhihu.com/?target=https%3A//mail.openjdk.java.net/pipermail/jdbc-spec-discuss/2019-September/000529.html&amp;nbsp; 于2019年官宣停止&lt;br&gt;&lt;/font&gt;2.&lt;/span&gt;&lt;span style=&quot;color: rgb(51 , 51 , 51) ; font-family: &amp;#34;pingfang sc&amp;#34; , &amp;#34;microsoft yahei&amp;#34; , &amp;#34;helvetica neue&amp;#34; , &amp;#34;helvetica&amp;#34; , &amp;#34;arial&amp;#34; , sans-serif ; background-color: rgb(255 , 255 , 255)&quot;&gt;&lt;b&gt;R2DBC&lt;/b&gt; (Reactive Relational Database Connectivity)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-weight: 600 ; color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;Spring&lt;/span&gt;&lt;span style=&quot;color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;&amp;nbsp;官方在&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-weight: 600 ; color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;Spring 5&lt;/span&gt;&lt;span style=&quot;color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;&amp;nbsp;发布了响应式&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-weight: 600 ; color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;Web&lt;/span&gt;&lt;span style=&quot;color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;&amp;nbsp;框架&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-weight: 600 ; color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;Spring WebFlux&lt;/span&gt;&lt;span style=&quot;color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;&amp;nbsp;之后急需能够满足异步响应的数据库交互&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-weight: 600 ; color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;API&lt;/span&gt;&lt;span style=&quot;color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;&amp;nbsp;。 由于缺乏标准和驱动，&lt;/span&gt;&lt;span style=&quot;font-weight: 600 ; color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;Pivotal（Spring 官方）&lt;/span&gt;&lt;span style=&quot;color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;&amp;nbsp;团队开始研究反应式关系型数据库连接（&lt;/span&gt;&lt;span style=&quot;font-weight: 600 ; color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;Reactive Relational Database Connectivity&lt;/span&gt;&lt;span style=&quot;color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;），并提出了&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-weight: 600 ; color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;R2DBC&lt;/span&gt;&lt;span style=&quot;color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;&amp;nbsp;规范&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-weight: 600 ; color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;API&lt;/span&gt;&lt;span style=&quot;color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;&amp;nbsp;以评估可行性并讨论数据库厂商是否有兴趣支持反应式的异步非阻塞驱动程序。最开始只有&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-weight: 600 ; color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;PostgreSQL&lt;/span&gt;&lt;span style=&quot;color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;&amp;nbsp;、&lt;/span&gt;&lt;span style=&quot;font-weight: 600 ; color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;H2&lt;/span&gt;&lt;span style=&quot;color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;、&lt;/span&gt;&lt;span style=&quot;font-weight: 600 ; color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;MSSQL&lt;/span&gt;&lt;span style=&quot;color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;&amp;nbsp;三家，现在&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-weight: 600 ; color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;MySQL&lt;/span&gt;&lt;span style=&quot;color: rgb(18 , 18 , 18) ; background-color: rgb(255 , 255 , 255)&quot;&gt;&amp;nbsp;也加入了进来&lt;/span&gt;&lt;/font&gt;&lt;span style=&quot;background-color: rgb(255 , 255 , 255)&quot;&gt;&lt;br&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="1640" y="415" width="650" height="250" as="geometry" />
        </mxCell>
        <mxCell id="75Hc36i8k2XXQKUzMVEF-5" value="基于响应式数据流的协议 RSocket" style="rounded=1;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="40" y="3460" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="75Hc36i8k2XXQKUzMVEF-6" value="" style="shape=singleArrow;direction=south;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="800" y="3300" width="60" height="100" as="geometry" />
        </mxCell>
        <mxCell id="75Hc36i8k2XXQKUzMVEF-9" value="RSocket是一种二进制子节流传输协议，提供4种交互模式&lt;br&gt;1.请求-响应 （request/response）&lt;br&gt;2.请求-响应流 （request/stream）&lt;br&gt;3.即发-即忘 （fire-and-forget）&lt;br&gt;4.通道 （channel）" style="rounded=1;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="220" y="3460" width="320" height="90" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
